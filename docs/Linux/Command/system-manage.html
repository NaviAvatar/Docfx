<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#31995;&#32479;&#31649;&#29702; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#31995;&#32479;&#31649;&#29702; ">
    <meta name="generator" content="docfx 2.59.0.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="系统管理">系统管理</h1>

<h2 id="1-linux-服务管理">1. linux 服务管理</h2>
<h3 id="进程和服务的介绍">进程和服务的介绍</h3>
<p>进程是程序装载入内存，正在被执行的程序。</p>
<p>服务是启动电脑后，常驻内存的一种进程。到关机时才退出。也称<strong>守护进程</strong>。</p>
<h3 id="service-服务管理">service 服务管理</h3>
<p>之前修改 ip 后，启动用 service network restart 命令，意思是重启网络服务。</p>
<p>centos 6版本的基本语法：</p>
<p><strong>service 服务名 start|stop|restart|status</strong></p>
<p>查看服务的方法：/etc/init.d/服务名</p>
<p>显示出来的四个，绿色的是可执行程序。</p>
<p>centos 7版本的基本语法：</p>
<p><strong>systemctl start|stop|restart|status	服务名</strong></p>
<p>查看服务的方法：/usr/lib/systemd/system</p>
<p>我们可以关掉 network 和 NetworkManager 服务，这样就不能访问网络了，外部物理机器有ping不通。</p>
<p>建议停掉 network ，启用 NetworkManager。</p>
<h2 id="2-系统运行级别">2. 系统运行级别</h2>
<p>输入命令行</p>
<p>终端输入 setup 回车，就会进入一个页面，选择系统服务，然后就进入到系统服务配置页面。</p>
<p><img src="pictures/systemService.png" alt=""></p>
<p>前面带星的是说这个服务开机自启动。无星说明开启不启动，需要手动启动。</p>
<p>选中后按空格，服务就不会自启动或者自启动。</p>
<p>&lt;SysV initscripts&gt; 说明是老版本的启动服务。systemd services  是新版本的服务。</p>
<h3 id="linux-进程运行级别">Linux 进程运行级别</h3>
<p>老版本：</p>
<p>开机——&gt;BIOS——&gt;/boot——&gt;init 进程——&gt;运行级别——&gt;运行级对应的服务</p>
<p>查看默认级别：vi /etc/inittab</p>
<p>Linux 系统有 7 种运行级别：常用3和5</p>
<table>
<thead>
<tr>
<th>运行级别</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>系统停机状态，系统默认运行级别不能设为 0，否则不能正常启动。</td>
</tr>
<tr>
<td>1</td>
<td>单用户工作状态，root 权限，用于系统维护，禁止远程登录。</td>
</tr>
<tr>
<td>2</td>
<td>多用户状态（没有NFS），登录后进入控制台命令模式。</td>
</tr>
<tr>
<td>3</td>
<td>完全的多用户状态（没有NFS），登录后进入控制台命令行模式。</td>
</tr>
<tr>
<td>4</td>
<td>系统未使用，保留</td>
</tr>
<tr>
<td>5</td>
<td>X11控制台。登录后进入图形GUI模式</td>
</tr>
<tr>
<td>6</td>
<td>系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动</td>
</tr>
</tbody>
</table>
<p>NFS ：network file system</p>
<p>CentOS 7 的运行级别简化为：</p>
<p>multi-user.target 等价于原运行级别3（多用户有网，无图形界面）</p>
<p>graphical.target 等价于原运行级别5（多用户有网，有图形界面）</p>
<p>查看当前运行级别：</p>
<p>systemctl get-default</p>
<p>命令行下转换运行级别：</p>
<table>
<thead>
<tr>
<th>运行级别转换命令</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>init 3</td>
<td>进入大黑框，需要登录 root 输入密码</td>
</tr>
<tr>
<td>init 5</td>
<td>进入图形界面，也需要登录用户密码</td>
</tr>
</tbody>
</table>
<h2 id="3-配置开机服务和防火墙">3. 配置开机服务和防火墙</h2>
<p>老版本：</p>
<p>chkconfig --list</p>
<p>列出老版本的SysV服务：</p>
<p><img src="pictures/6.png" alt=""></p>
<p>假如我们用setup去关闭 network，再回来看，<strong>2-6的运行级别被关掉了：</strong></p>
<p><img src="pictures/7.png" alt=""></p>
<p>使用命令行操作的话就是：</p>
<p>chkconfig newtork on/off</p>
<p>下面这个操作是把network对应的3级别关掉：</p>
<p>chkconfig --level 3 network off</p>
<p>我们查看 NetworkManager的状态，会发现它的状态是 enabled 的</p>
<p><img src="pictures/8.png" alt=""></p>
<p>如果想改成开机不要自启动，直接输入下面的命令：</p>
<p>systemctl disable NetworkManager</p>
<p>再次查看状态：</p>
<p><img src="pictures/9.png" alt=""></p>
<p>如果想改成开机自启动，就输入下面的命令：</p>
<p>systemctl enable NetworkManager</p>
<p>查看开机自启动的服务：</p>
<p>systemctl list-unit-files</p>
<p><img src="pictures/10.png" alt=""></p>
<p>可以看出服务有三种状态：</p>
<table>
<thead>
<tr>
<th>状态</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>enabled</td>
<td>开机启动</td>
</tr>
<tr>
<td>disabled</td>
<td>开机不启动</td>
</tr>
<tr>
<td>static</td>
<td>不确定，这个服务依赖于其他服务。服务启动用到其他服务A，A没启动它就没法启动。</td>
</tr>
</tbody>
</table>
<h3 id="实战配置防火墙的自启动">实战：配置防火墙的自启动</h3>
<p>防火墙：</p>
<p>老版本：iptables</p>
<p>CentOS 7：fire walld</p>
<p>还记得查看服务状态吗？</p>
<p>systemctl status firewalld，</p>
<p>[防火墙]: <a href="https://baike.baidu.com/item/%E9%98%B2%E7%81%AB%E5%A2%99/52767">https://baike.baidu.com/item/%E9%98%B2%E7%81%AB%E5%A2%99/52767</a>	&quot;防火墙能做什么&quot;</p>
<p><img src="pictures/11.png" alt=""></p>
<p>看出是 enabled，是开机自启动的，意味着如果现在输入命令行 systemctl stop firewalld，防火墙会立即停止，但是下次开机，防火墙又自动开启。</p>
<p>要关闭其开机自启动，就要输入 systemctl disable firewalld.service。但是 5 级别下它还是开机自启动的。</p>
<h2 id="4-关机重启">4. 关机&amp;重启</h2>
<table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>shutdown</td>
<td>1分钟后立即关机</td>
</tr>
<tr>
<td>shutdown -c</td>
<td>撤销关机</td>
</tr>
<tr>
<td>shutdown now</td>
<td>立即关机</td>
</tr>
<tr>
<td>shutdown 3</td>
<td>3 分钟后关机</td>
</tr>
<tr>
<td>shutdown 15:28</td>
<td>在 15:28:00 时刻立即执行关机</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>为什么 shutdown 默认会等一会儿再关闭？</p>
<p>因为要执行 sync。</p>
<table>
<thead>
<tr>
<th>基本语法</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>shutdown [选项] 时间</td>
<td>-H，相当于 halt，停机<br>-r，= reboot 重启<br>now，立即关机<br>时间，等待多久后关机</td>
</tr>
<tr>
<td>sync</td>
<td>将数据由内存同步到硬盘中。</td>
</tr>
<tr>
<td>halt</td>
<td>停机，关闭系统，但不断电。</td>
</tr>
<tr>
<td>poweroff</td>
<td>关机，断电</td>
</tr>
<tr>
<td>reboot</td>
<td>重启，等同于 shutdown -r now</td>
</tr>
</tbody>
</table>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/NaviAvatar/Docfx/blob/master/Linux/Command/system-manage.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
